<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="css/style.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,700" rel="stylesheet">
  <title>Document</title>
</head>
<body>
  <main>
    <button class="add-btn"></button>
    <div class="chats-container"></div>
    <template class="chat-window-tempate">
      <div class="chat-window">
        <header class="chat-header"></header>
        <iframe class="chat-iframe"></iframe>
      </div>
    </template>
  </main>
  <script src="script/send-message.js"></script>
  <script>
    var addBtn = document.querySelector('.add-btn');

    function ChatWindow() {
      var template = document.querySelector('.chat-window-tempate').content;
      var chatWindow = template.cloneNode(true);
      ChatWindow.counter++;

      chatWindow.querySelector('.chat-header').textContent = 'Window #' + ChatWindow.counter;
      chatWindow.querySelector('.chat-iframe').src = 'chat.html';

      return chatWindow;
    } 

    ChatWindow.counter = 0;

    function addChatWindow() {
      var chatsContainer = document.querySelector('.chats-container');
      var chatWindow = new ChatWindow();

      chatsContainer.appendChild(chatWindow);
    }

    function addBtnClickHandler() {
      addChatWindow();
      window.sendMessage({
        text: "Window #" + ChatWindow.counter + " has joined",
        info: true
      })
    }

    addBtn.addEventListener('click', addBtnClickHandler);

  </script>
</body>
</html>